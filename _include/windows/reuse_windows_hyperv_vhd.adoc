= 
:allow-uri-read: 


ディスクパーティションのデータブロック境界が基盤となるLUNのブロック境界と一致していない場合、ストレージシステムは多くの場合、オペレーティングシステムのブロック読み取りまたは書き込みごとにブロック読み取りまたは書き込みを2回実行する必要があります。ミスアライメントが原因で追加のブロック読み取り / 書き込みが発生すると、深刻なパフォーマンスの問題が生じる可能性があります。

マスターブートレコードによって定義された各パーティションの開始セクターの場所が、ミスアライメントの原因となります。


NOTE: Windows Server 2016 で作成されたパーティションは、デフォルトでアライメントされる必要があります。

ONTAP PowerShell Toolkitのコマンドレットを使用し `Get-NaVirtualDiskAlignment`て、パーティションが基盤となるLUNとアライメントされているかどうかを確認します。パーティションのアライメントが正しくない場合は、コマンドレットを使用し `Repair-NaVirtualDiskAlignment`て、アライメントが正しい新しいVHDファイルを作成します。このコマンドレットは、すべてのパーティションを新しいファイルにコピーします。元の VHD ファイルは変更も削除もされません。データがコピーされている間は、仮想マシンをシャットダウンする必要があります。

ONTAP PowerShell Toolkit は、ネットアップコミュニティからダウンロードできます。環境変数で指定された場所にファイルを解凍する必要があります（またはスクリプトを使用してファイルを `%PSModulePath%`解凍し `DataONTAP.zip`ます `Install.ps1`）。インストールが完了したら、コマンドレットを使用して `Show-NaHelp`コマンドレットのヘルプを表示します。

PowerShell Toolkit では、 MBR タイプのパーティションを含む容量固定 VHD ファイルのみがサポートされます。WindowsダイナミックディスクまたはGPTパーティションを使用するVHDはサポートされていません。さらに、 PowerShell Toolkit では、 4GB 以上のパーティションサイズが必要です。小さいパーティションは正しくアライメントできません。


NOTE: Linux 仮想マシンで VHD の GRUB ブートローダーを使用する場合は、 PowerShell Toolkit の実行後にブート設定を更新する必要があります。
